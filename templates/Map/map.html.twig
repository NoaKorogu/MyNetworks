{% extends 'base.html.twig' %}

{% block title %}Carte{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
<link rel="stylesheet" href="{{ asset('css/map.css') }}">
{% endblock %}

{% block body %}

    <div id="app">
        <div id="sidebar">
            {% if app.user %}
                <button onclick="enableWaypointMode()">Créer un Waypoint</button>
                <button onclick="enableDrawingMode()">Créer un chemin</button>
                <button id="endPathButton" onclick="finishDrawing()" disabled>Fin de la création du chemin</button>
            {% endif %}
            <label><input type="checkbox" id="toggle-water" onchange="toggleWaterLines()" 
                {% if not (is_granted('ROLE_EDF') or is_granted('ROLE_USER') or is_granted('ROLE_ADMIN') or app.user is null) %}disabled{% endif %}>
                Afficher les lignes d'électricité
            </label><br>
            <label><input type="checkbox" id="toggle-gas" onchange="toggleGasLines()" 
                {% if not (is_granted('ROLE_WATER') or is_granted('ROLE_USER') or is_granted('ROLE_ADMIN') or app.user is null) %}disabled{% endif %}>
                Afficher les lignes d'eau
            </label><br>
            <label><input type="checkbox" id="toggle-bus" onchange="toggleBusLines()" 
                {% if not (is_granted('ROLE_FILIBUS') or is_granted('ROLE_USER') or is_granted('ROLE_ADMIN') or app.user is null) %}disabled{% endif %}>
                Afficher les lignes de bus
            </label><br>
        </div>
        <div id="map-container">
            <div id="map"></div>
            <div id="search-bar-container">
                <input type="text" id="search-bar" placeholder="Rechercher un lieu..." />
                <button id="search-button" onclick="searchLocation()">Rechercher</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" defer></script>
    <script src="https://unpkg.com/osmtogeojson@6.0.0/dist/osmtogeojson.umd.js" defer></script>
    <script src="{{ asset('js/component/color_picker.js') }}" defer></script>
    <script src="{{ asset('js/map.js') }}" defer></script>
    <script type="module" src="{{ asset('js/create_way.js') }}" defer></script>

{% endblock %}
